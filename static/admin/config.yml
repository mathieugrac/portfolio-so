# Sveltia CMS Configuration (drop-in Decap CMS replacement)
# Using custom OAuth endpoint on Vercel

backend:
  name: github
  repo: mathieugrac/portfolio-so
  branch: main
  base_url: https://portfolio-so.vercel.app
  auth_endpoint: /api/auth

# Where uploaded images are stored
media_folder: "static/img/uploads"
public_folder: "/img/uploads"

# Locale
locale: "fr"

# Collections
collections:
  # ==================
  # PROJECTS COLLECTION
  # ==================
  - name: "projects"
    label: "Projets"
    folder: "src/content/projects"
    create: true
    slug: "{{slug}}"
    extension: "md"
    format: "yaml-frontmatter"
    sortable_fields: ["title", "year"]
    view_groups:
      - label: "Ann√©e"
        field: year
    fields:
      # Basic info
      - name: "title"
        label: "Titre"
        widget: "string"
        required: true

      - name: "slug"
        label: "URL (slug)"
        widget: "string"
        required: true
        pattern:
          ["^[a-z0-9-]+$", "Uniquement lettres minuscules, chiffres et tirets"]
        hint: "Ex: art-de-la-joie (sera l'URL /projects/art-de-la-joie)"

      - name: "subtitle"
        label: "Sous-titre"
        widget: "string"
        required: false
        hint: "Ex: d'apr√®s Goliarda Sapienza"

      - name: "year"
        label: "Ann√©e"
        widget: "number"
        value_type: "int"
        min: 2000
        max: 2030
        required: true

      - name: "director"
        label: "Metteur en sc√®ne"
        widget: "string"
        required: true

      - name: "cover"
        label: "Image de couverture"
        widget: "image"
        required: true
        hint: "Image affich√©e sur la page d'accueil"

      - name: "description"
        label: "Description (√Ä propos)"
        widget: "text"
        required: false
        hint: "Texte affich√© dans la section '√Ä propos'"

      # Distribution (credits)
      - name: "distribution"
        label: "Distribution"
        widget: "list"
        required: false
        collapsed: true
        summary: "{{fields.role}}: {{fields.name}}"
        fields:
          - name: "role"
            label: "R√¥le"
            widget: "string"
            hint: "Ex: Mise en sc√®ne, Sc√©nographie, Costumes..."
          - name: "name"
            label: "Nom(s)"
            widget: "string"

      # Content blocks (the magic!)
      - name: "blocks"
        label: "Contenu (blocs)"
        widget: "list"
        required: false
        types:
          # Image block
          - name: "image"
            label: "üì∑ Image"
            widget: "object"
            summary: "Image: {{fields.alt}} ({{fields.layout}})"
            fields:
              - name: "src"
                label: "Image"
                widget: "image"
                required: true
              - name: "alt"
                label: "Texte alternatif"
                widget: "string"
                required: true
                hint: "Description de l'image pour l'accessibilit√©"
              - name: "layout"
                label: "Disposition"
                widget: "select"
                default: "center"
                options:
                  - { label: "Pleine largeur", value: "center" }
                  - { label: "√Ä gauche", value: "left" }
                  - { label: "√Ä droite", value: "right" }
              - name: "caption"
                label: "L√©gende"
                widget: "string"
                required: false

          # Text block
          - name: "text"
            label: "üìù Texte"
            widget: "object"
            summary: "Texte: {{fields.content | truncate(50)}}"
            fields:
              - name: "content"
                label: "Contenu"
                widget: "markdown"
                required: true

  # ==================
  # SITE SETTINGS
  # ==================
  - name: "settings"
    label: "Param√®tres du site"
    files:
      - name: "site"
        label: "Informations g√©n√©rales"
        file: "src/content/settings/site.yml"
        fields:
          - name: "name"
            label: "Nom"
            widget: "string"
          - name: "email"
            label: "Email de contact"
            widget: "string"
          - name: "portrait"
            label: "Photo de profil"
            widget: "image"
          - name: "headline"
            label: "Titre d'introduction"
            widget: "string"
          - name: "subheadline"
            label: "Sous-titre d'introduction"
            widget: "text"

      - name: "projects_order"
        label: "Ordre des projets"
        file: "src/content/settings/projects-order.yml"
        fields:
          - name: "order"
            label: "Ordre d'affichage"
            widget: "list"
            label_singular: "Projet"
            hint: "Glissez-d√©posez pour r√©organiser. Le premier projet de la liste appara√Æt en haut de la page d'accueil. Les nouveaux projets non list√©s appara√Ætront automatiquement en premier."
            field:
              name: "slug"
              label: "Projet (slug)"
              widget: "relation"
              collection: "projects"
              search_fields: ["title", "slug"]
              value_field: "slug"
              display_fields: ["title", " (", "year", ")"]

  # ==================
  # PARCOURS (CV)
  # ==================
  - name: "parcours"
    label: "Parcours"
    files:
      - name: "experience"
        label: "Exp√©riences"
        file: "src/content/parcours/experience.yml"
        fields:
          - name: "items"
            label: "Exp√©riences"
            widget: "list"
            collapsed: true
            summary: "{{fields.year}}"
            fields:
              - name: "year"
                label: "Ann√©e"
                widget: "string"
              - name: "projects"
                label: "Projets"
                widget: "list"
                fields:
                  - name: "title"
                    label: "Titre"
                    widget: "string"
                  - name: "role"
                    label: "R√¥le"
                    widget: "string"
                    required: false
                  - name: "desc"
                    label: "Description"
                    widget: "string"

      - name: "formation"
        label: "Formation"
        file: "src/content/parcours/formation.yml"
        fields:
          - name: "items"
            label: "Formations"
            widget: "list"
            collapsed: true
            summary: "{{fields.year}}"
            fields:
              - name: "year"
                label: "Ann√©e"
                widget: "string"
              - name: "projects"
                label: "Dipl√¥mes/Formations"
                widget: "list"
                fields:
                  - name: "title"
                    label: "Titre"
                    widget: "string"
                  - name: "desc"
                    label: "Description"
                    widget: "string"
